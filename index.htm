<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Codeable Sales Derby - Fast & Furious Showdown üèá</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* === BASE STYLES - Making it look like a real race track === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(180deg, #0a1f3a 0%, #152a57 100%);
            min-height: 100vh;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(30, 144, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(50, 205, 50, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.05) 0%, transparent 30%);
            pointer-events: none;
            z-index: -2;
        }

        /* === MAIN CONTAINER - Like a race day program === */
        .race-container {
            max-width: 1000px;
            width: 100%;
            background: rgba(0, 15, 30, 0.85);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 35px;
            box-shadow: 
                0 20px 80px rgba(0, 0, 0, 0.7),
                0 0 0 1px rgba(255, 215, 0, 0.1),
                inset 0 0 30px rgba(0, 60, 120, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .race-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                #FFD700 0%, 
                #FF8C00 25%, 
                #4CAF50 50%, 
                #2196F3 75%, 
                #FFD700 100%);
            z-index: 1;
        }

        /* === HEADER - Race title with effects === */
        .race-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .race-title {
            font-size: 3.2em;
            background: linear-gradient(45deg, #FFD700, #FF8C00, #4CAF50, #2196F3);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            0% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.3), 0 0 40px rgba(255, 140, 0, 0.2); }
            100% { text-shadow: 0 0 30px rgba(255, 215, 0, 0.5), 0 0 60px rgba(255, 140, 0, 0.3), 0 0 80px rgba(76, 175, 80, 0.2); }
        }

        .race-subtitle {
            font-size: 1.3em;
            color: #a0c8ff;
            margin-bottom: 25px;
            font-style: italic;
        }

        /* === ELLIPTICAL RACE TRACK - The main event! === */
        .track-container {
            position: relative;
            width: 580px;
            height: 420px;
            margin: 0 auto 50px;
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .track-surface {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 5px solid transparent;
            border-radius: 50% 50% 50% 50% / 65% 65% 35% 35%;
            background: 
                linear-gradient(45deg, #2d5010 0%, #4a7c1c 25%, #2d5010 50%, #4a7c1c 75%, #2d5010 100%),
                repeating-linear-gradient(45deg, 
                    transparent, 
                    transparent 10px, 
                    rgba(255, 255, 255, 0.05) 10px, 
                    rgba(255, 255, 255, 0.05) 20px);
            background-size: 400% 400%, 100% 100%;
            animation: trackPattern 20s linear infinite;
            box-shadow: 
                inset 0 0 100px rgba(0, 0, 0, 0.8),
                inset 0 0 60px rgba(30, 144, 255, 0.1),
                0 20px 60px rgba(0, 0, 0, 0.6);
        }

        @keyframes trackPattern {
            0% { background-position: 0% 0%, 0 0; }
            100% { background-position: 400% 400%, 0 0; }
        }

        .track-lanes {
            position: absolute;
            width: 90%;
            height: 75%;
            top: 12.5%;
            left: 5%;
            border: 2px dashed rgba(255, 255, 255, 0.15);
            border-radius: 50% 50% 50% 50% / 65% 65% 35% 35%;
        }

        .inner-turf {
            position: absolute;
            width: 60%;
            height: 40%;
            top: 30%;
            left: 20%;
            background: linear-gradient(135deg, #1a4f1a, #2d7a2d);
            border-radius: 50%;
            box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.5);
        }

        /* === RACER PROFILES - With photos! === */
        .racer-avatar {
            position: absolute;
            width: 65px;
            height: 65px;
            border-radius: 50%;
            border: 4px solid;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transform-origin: center;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.5),
                0 0 0 4px rgba(255, 255, 255, 0.1);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
        }

        .racer-avatar::before {
            content: '';
            position: absolute;
            inset: -8px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, transparent, currentColor, transparent);
            animation: spinBorder 2s linear infinite;
            opacity: 0;
            transition: opacity 0.3s;
        }

        @keyframes spinBorder {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .racer-avatar.boosting::before {
            opacity: 1;
        }

        .racer-avatar#avatar1 {
            border-color: #4CAF50;
            background-image: url('https://www.codeable.io/wp-content-new/uploads/2025/03/6687-profile_f5ebd107fd4fa05a27e96dda8a21713b.jpeg');
        }

        .racer-avatar#avatar2 {
            border-color: #2196F3;
            background-image: url('https://storage.googleapis.com/avatars-production.codeable.io/22877/profile_12cb1a5b446edf8906801156245b0456.jpeg');
        }

        .racer-name-tag {
            position: absolute;
            top: -45px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1em;
            white-space: nowrap;
            border: 2px solid currentColor;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            z-index: 11;
        }

        #avatar1 .racer-name-tag { color: #4CAF50; }
        #avatar2 .racer-name-tag { color: #2196F3; }

        /* === FINISH LINE & TROPHY === */
        .finish-line {
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 180px;
            background: repeating-linear-gradient(
                180deg,
                #000 0px,
                #000 10px,
                #FFD700 10px,
                #FFD700 20px
            );
            z-index: 5;
            box-shadow: 
                0 0 30px #FFD700,
                inset 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .trophy-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4.5em;
            opacity: 0.25;
            filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.5));
            z-index: 2;
        }

        /* === PROGRESS TRACKER - For the impatient viewers === */
        .progress-container {
            background: rgba(0, 20, 40, 0.7);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.3);
        }

        .racer-progress {
            height: 70px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 0 25px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .racer-progress.winner-pulse {
            animation: winnerPulse 2s infinite;
        }

        @keyframes winnerPulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.3); }
            70% { box-shadow: 0 0 0 25px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }

        .racer-icon {
            font-size: 2.2em;
            margin-right: 25px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
            animation: bounce 0.5s infinite alternate;
        }

        @keyframes bounce {
            0% { transform: translateY(0); }
            100% { transform: translateY(-5px); }
        }

        .racer-label {
            font-weight: bold;
            font-size: 1.4em;
            min-width: 180px;
            margin-right: 30px;
        }

        .progress-bar {
            flex: 1;
            height: 28px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 14px;
            overflow: hidden;
            margin-right: 30px;
            box-shadow: inset 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        .progress-fill {
            height: 100%;
            border-radius: 14px;
            width: 0%;
            transition: width 0.3s ease-out;
            position: relative;
            overflow: hidden;
        }

        #fill1 {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
        }

        #fill2 {
            background: linear-gradient(90deg, #2196F3, #03A9F4);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.3) 50%, 
                transparent 100%);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .racer-score {
            font-size: 1.5em;
            font-weight: bold;
            min-width: 130px;
            text-align: right;
            color: #FFD700;
            text-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
        }

        /* === RACE COMMENTARY - The voice of the race! === */
        .commentary-box {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid rgba(255, 215, 0, 0.3);
            position: relative;
            min-height: 100px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        }

        .commentary-box::before {
            content: 'üì¢ RACE COMMENTARY';
            position: absolute;
            top: -12px;
            left: 30px;
            background: linear-gradient(45deg, #FFD700, #FF8C00);
            padding: 5px 20px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
            color: #000;
        }

        .commentary-text {
            font-size: 1.4em;
            line-height: 1.5;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .commentary-text.highlight {
            color: #FFD700;
            transform: scale(1.02);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        /* === CONTROLS & STATS === */
        .race-controls {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 35px;
            margin-bottom:60px;
        }

        .race-btn {
            padding: 20px 45px;
            font-size: 1.3em;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .race-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }

        .race-btn:active {
            transform: translateY(-1px);
        }

        #startRace {
            background: linear-gradient(45deg, #FFD700, #FF8C00);
            color: #000;
        }

        #resetRace {
            background: linear-gradient(45deg, #4CAF50, #2E7D32);
            color: white;
        }

        .race-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item {
            text-align: center;
            font-size: 0.95em;
        }

        .stat-value {
            display: block;
            font-size: 1.4em;
            font-weight: bold;
            color: #FFD700;
            margin-top: 5px;
        }

        /* === SPECIAL EFFECTS - Because why not? === */
        .boost-effect {
            position: absolute;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(255,215,0,0.8) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 20;
            opacity: 0;
        }

        .lap-counter {
            position: absolute;
            bottom: -35px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 1.1em;
            color: #a0c8ff;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* === TIMER - For the faster race === */
        .race-timer {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 1.8em;
            font-weight: bold;
            color: #FFD700;
            border: 2px solid rgba(255, 215, 0, 0.3);
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5);
        }

        .music-indicator {
            position: absolute;
            top: 30px;
            left: 30px;
            background: rgba(30, 144, 255, 0.2);
            padding: 12px 20px;
            border-radius: 15px;
            font-size: 1em;
            border: 1px solid rgba(30, 144, 255, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .music-indicator.playing {
            animation: musicPulse 1s infinite;
        }

        @keyframes musicPulse {
            0% { box-shadow: 0 0 0 0 rgba(30, 144, 255, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(30, 144, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(30, 144, 255, 0); }
        }
    </style>
</head>
<body>
    <div class="race-container">
        <!-- Race timer in the corner -->
        <div class="race-timer" id="raceTimer">00:00</div>
        
        <!-- Main header -->
        <div class="race-header">
            <h1 class="race-title">üèá CODEABLE SALES DERBY üèá</h1>
            <p class="race-subtitle">The Ultimate Showdown: Who Will Win the Retainer Race?</p>
        </div>

        <!-- Controls -->
        <div class="race-controls">
            <button class="race-btn" id="startRace" onclick="startEpicRace()">
                <span>üèÅ</span> START EPIC RACE
            </button>
            <button class="race-btn" id="resetRace" onclick="resetRace()">
                <span>üîÑ</span> RESET RACE
            </button>
        </div>
        
        <!-- Elliptical race track -->
        <div class="track-container">
            <div class="track-surface"></div>
            <div class="track-lanes"></div>
            <div class="inner-turf"></div>
            <div class="finish-line"></div>
            <div class="trophy-center">üèÜ</div>
            
            <!-- Racers with profile photos -->
            <div class="racer-avatar" id="avatar1">
                <div class="racer-name-tag">@zeshanshani</div>
            </div>
            <div class="racer-avatar" id="avatar2">
                <div class="racer-name-tag">@Marcel</div>
            </div>
            
            <div class="lap-counter" id="lapCounter">Lap 1/2 ‚Ä¢ Fast Sprint!</div>
        </div>
        
        <!-- Race commentary -->
        <div class="commentary-box">
            <div class="commentary-text" id="commentary">
                The horses are in the gates! Who will claim victory today? üèÅ
            </div>
        </div>
        
        <!-- Progress bars -->
        <div class="progress-container">
            <div class="racer-progress" id="progressBar1">
                <div class="racer-icon">üêé</div>
                <div class="racer-label">@zeshanshani</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="fill1"></div>
                </div>
                <div class="racer-score" id="score1">1,960 pts</div>
            </div>
            
            <div class="racer-progress" id="progressBar2">
                <div class="racer-icon">üê¥</div>
                <div class="racer-label">@Marcel</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="fill2"></div>
                </div>
                <div class="racer-score" id="score2">2,033 pts</div>
            </div>
        </div>
    </div>
    
    <!-- Hidden audio for race music -->
    <audio id="raceMusic" preload="auto">
        <source src="https://jellypixelstudio.com/wp-content/uploads/2026/02/sai-ma.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // ==================== RACE CONFIGURATION ====================
        // This is where all the magic numbers live - MUCH FASTER NOW!
        const RACE_CONFIG = {
            totalTime: 60, // 1 minute race (was 173 seconds)
            totalLaps: 2,  // Reduced from 3 laps
            racers: [
                {
                    name: "@zeshanshani",
                    score: 1960,
                    color: "#4CAF50",
                    avatarId: "avatar1",
                    progressId: "fill1",
                    strategy: "volume"
                },
                {
                    name: "@Marcel",
                    score: 2033,
                    color: "#2196F3",
                    avatarId: "avatar2",
                    progressId: "fill2",
                    strategy: "enterprise"
                }
            ]
        };

        // ==================== EPIC RACE COMMENTARY - FASTER TIMING ====================
        // All commentary timing adjusted for 1-minute race
        const RACE_COMMENTARY = [
            { time: 0, message: "üé∫ AND THEY'RE OFF! The race for Codeable supremacy BEGINS! üèá" },
            { time: 3, message: "üöÄ @zeshanshani with a ROCKET START! Four retainers = SPEED! üí®" },
            { time: 8, message: "üèéÔ∏è Building a commanding lead in the first lap! ü•á" },
            { time: 15, message: "üëÄ @Marcel is finding his rhythm. Enterprise engine warming up... ‚öôÔ∏è" },
            { time: 22, message: "üíé ENTERPRISE POWER ACTIVATED! Marcel starts to close the gap! ‚ö°" },
            { time: 30, message: "üî• @zeshanshani responds! Volume strategy holding strong! üìà" },
            { time: 38, message: "üéØ SECOND LAP! Marcel switching gears... the chase is ON! üö®" },
            { time: 45, message: "‚ö°‚ö°‚ö° BOOST EFFECT! Enterprise power kicking in! +500 points! üöÄ" },
            { time: 50, message: "üò± UNBELIEVABLE! Marcel pulls ALONGSIDE! This is INCREDIBLE! ü§Ø" },
            { time: 55, message: "üèÅ APPROACHING THE FINISH LINE! IT'S TOO CLOSE TO CALL! üì∏" },
            { time: 58, message: "üéä PHOTO FINISH! Waiting for the official results... ü§û" },
            { time: 60, message: "üèÜüèÜüèÜ @MARCEL WINS! ENTERPRISE POWER PREVAILS! KING OF THE MOUNTAIN! üëë" }
        ];

        // ==================== GLOBAL VARIABLES ====================
        // Keeping track of everything that's happening
        let raceInterval;
        let currentTime = 0;
        let raceActive = false;
        let currentLap = 1;
        const raceMusic = document.getElementById('raceMusic');
        
        // Progress tracking for dramatic moments
        let progress1 = 0;
        let progress2 = 0;
        let commentaryIndex = 0;
        let lastBoostTime = 0;

        // ==================== ELLIPTICAL TRACK CALCULATIONS ====================
        // Math magic to make the avatars move smoothly around the oval
        function calculateEllipticalPosition(progress, width, height) {
            // Convert progress percentage to radians (full circle = 2œÄ)
            const angle = (progress / 100) * 2 * Math.PI;
            
            // Ellipse dimensions (making it oval-shaped)
            const a = width * 0.4;  // Horizontal radius
            const b = height * 0.3; // Vertical radius
            
            // Standard ellipse parametric equations
            const x = a * Math.cos(angle);
            const y = b * Math.sin(angle);
            
            // Adjust for track center and scale
            return {
                x: (width / 2) + x - 32, // -32 to center the avatar
                y: (height / 2) + y - 32
            };
        }

        // ==================== RACE POSITION UPDATER ====================
        // This function moves the avatars around the track
        function updateRacePositions() {
            const track = document.querySelector('.track-container');
            const trackWidth = track.offsetWidth;
            const trackHeight = track.offsetHeight;
            
            // Update first racer position
            const pos1 = calculateEllipticalPosition(progress1, trackWidth, trackHeight);
            const avatar1 = document.getElementById('avatar1');
            avatar1.style.left = `${pos1.x}px`;
            avatar1.style.top = `${pos1.y}px`;
            
            // Update second racer position
            const pos2 = calculateEllipticalPosition(progress2, trackWidth, trackHeight);
            const avatar2 = document.getElementById('avatar2');
            avatar2.style.left = `${pos2.x}px`;
            avatar2.style.top = `${pos2.y}px`;
            
            // Update lap counter
            const maxProgress = Math.max(progress1, progress2);
            const newLap = Math.floor(maxProgress / (100 / RACE_CONFIG.totalLaps)) + 1;
            
            if (newLap !== currentLap && newLap <= RACE_CONFIG.totalLaps) {
                currentLap = newLap;
                document.getElementById('lapCounter').textContent = 
                    `Lap ${currentLap}/${RACE_CONFIG.totalLaps} ‚Ä¢ Fast Sprint!`;
                
                // Special lap change effect
                if (currentLap === RACE_CONFIG.totalLaps) {
                    showSpecialEffect("üé™ FINAL LAP! EVERYTHING ON THE LINE! üèÅ");
                }
            }
        }

        // ==================== SPECIAL EFFECTS SYSTEM ====================
        // Because every epic race needs explosions and boosts!
        function createBoostEffect(x, y, color) {
            const effect = document.createElement('div');
            effect.className = 'boost-effect';
            effect.style.left = `${x}px`;
            effect.style.top = `${y}px`;
            effect.style.background = `radial-gradient(circle, ${color} 0%, transparent 70%)`;
            effect.style.opacity = '0.8';
            
            document.querySelector('.track-container').appendChild(effect);
            
            // Animate the boost
            const animation = effect.animate([
                { transform: 'scale(0.5)', opacity: 0.8 },
                { transform: 'scale(2)', opacity: 0 }
            ], {
                duration: 600,
                easing: 'ease-out'
            });
            
            animation.onfinish = () => effect.remove();
        }

        function showSpecialEffect(text) {
            const commentary = document.getElementById('commentary');
            commentary.textContent = text;
            commentary.classList.add('highlight');
            
            setTimeout(() => {
                commentary.classList.remove('highlight');
            }, 1000);
        }

        // ==================== RACE PROGRESSION LOGIC - MUCH FASTER ====================
        // The heart of the race - how fast each racer progresses
        function calculateRaceProgress(elapsedTime) {
            // Racer 1 (@zeshanshani) - Volume strategy: VERY fast start, steady pace
            if (progress1 < 96) {
                if (elapsedTime < 15) {
                    progress1 += 1.8; // Very fast start
                } else if (elapsedTime < 35) {
                    progress1 += 1.2; // Maintaining
                } else if (elapsedTime < 50) {
                    progress1 += 0.6; // Slowing down
                } else {
                    progress1 += 0.3; // Tired finish
                }
            }
            
            // Racer 2 (@Marcel) - Enterprise strategy: slower start, explosive finish
            if (progress2 < 100) {
                if (elapsedTime < 10) {
                    progress2 += 0.4; // Conservative start
                } else if (elapsedTime < 25) {
                    progress2 += 0.9; // Building momentum
                } else if (elapsedTime < 40) {
                    // ENTERPRISE BOOST ZONE!
                    progress2 += 1.8;
                    
                    // Visual boost effect
                    if (elapsedTime - lastBoostTime > 8) {
                        const avatar = document.getElementById('avatar2');
                        const rect = avatar.getBoundingClientRect();
                        const trackRect = document.querySelector('.track-container').getBoundingClientRect();
                        
                        createBoostEffect(
                            rect.left - trackRect.left + 32,
                            rect.top - trackRect.top + 32,
                            '#2196F3'
                        );
                        
                        avatar.classList.add('boosting');
                        setTimeout(() => avatar.classList.remove('boosting'), 600);
                        
                        lastBoostTime = elapsedTime;
                    }
                } else if (elapsedTime < 55) {
                    progress2 += 2.5; // FINAL SPRINT!
                } else {
                    progress2 += 3.5; // LAST PUSH TO VICTORY!
                }
            }
            
            // Cap the progress
            progress1 = Math.min(progress1, 96);
            progress2 = Math.min(progress2, 100);
            
            // Update progress bars
            document.getElementById('fill1').style.width = `${progress1}%`;
            document.getElementById('fill2').style.width = `${progress2}%`;
            
            // Update positions
            updateRacePositions();
            
            // Check for dramatic moments
            checkDramaticMoments(elapsedTime);
            
            // Check for winner
            if (progress2 >= 100) {
                finishRace();
            }
        }

        // ==================== DRAMATIC MOMENT CHECKER ====================
        // Adds commentary and effects at key moments
        function checkDramaticMoments(elapsedTime) {
            // Update commentary based on time
            if (commentaryIndex < RACE_COMMENTARY.length - 1) {
                const nextCommentary = RACE_COMMENTARY[commentaryIndex + 1];
                
                if (elapsedTime >= nextCommentary.time) {
                    commentaryIndex++;
                    document.getElementById('commentary').textContent = nextCommentary.message;
                    
                    // Special effects for certain messages
                    if (nextCommentary.message.includes('BOOST') || 
                        nextCommentary.message.includes('ENTERPRISE POWER')) {
                        document.getElementById('commentary').classList.add('highlight');
                        setTimeout(() => {
                            document.getElementById('commentary').classList.remove('highlight');
                        }, 800);
                    }
                }
            }
            
            // Visual effects when racers are close
            const gap = Math.abs(progress1 - progress2);
            if (gap < 15 && elapsedTime > 30) {
                // Make the track glow when it's close
                document.querySelector('.track-surface').style.boxShadow = 
                    `inset 0 0 100px rgba(0, 0, 0, 0.8),
                     inset 0 0 60px rgba(255, 0, 0, 0.2),
                     0 20px 60px rgba(0, 0, 0, 0.6)`;
            }
        }

        // ==================== RACE TIMER ====================
        // Keeps perfect time for our 1-minute race
        function updateRaceTimer() {
            currentTime++;
            const minutes = Math.floor(currentTime / 60);
            const seconds = currentTime % 60;
            
            document.getElementById('raceTimer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Calculate progress based on exact 1-minute duration
            calculateRaceProgress(currentTime);
        }

        // ==================== RACE START - THE MAIN EVENT! ====================
        function startEpicRace() {
            if (raceActive) return;
            
            // Reset everything
            resetRace();
            raceActive = true;
            
            // Start the epic race music!
            raceMusic.currentTime = 0;
            raceMusic.play().catch(e => console.log("Music play failed:", e));
            
            // Update music indicator
            const musicIndicator = document.getElementById('musicIndicator');
            musicIndicator.innerHTML = '<span>üéµ</span> Sai-Ma Anthem Playing!';
            musicIndicator.classList.add('playing');
            
            // Show starting message
            document.getElementById('commentary').textContent = 
                "üé∫ LADIES AND GENTLEMEN! START YOUR ENGINES! THE 1-MINUTE SHOWDOWN BEGINS! üöÄ";
            
            // Start the race timer - UPDATE EVERY 500ms INSTEAD OF 1000ms for faster race
            raceInterval = setInterval(updateRaceTimer, 500);
            
            // Disable start button during race
            document.getElementById('startRace').disabled = true;
            document.getElementById('startRace').style.opacity = '0.7';
            document.getElementById('startRace').innerHTML = '<span>‚è≥</span> RACE IN PROGRESS';
        }

        // ==================== RACE FINISH - CROWN THE WINNER! ====================
        function finishRace() {
            clearInterval(raceInterval);
            raceActive = false;
            
            // Stop the music immediately
            raceMusic.pause();
            raceMusic.currentTime = 0;
            
            document.getElementById('musicIndicator').classList.remove('playing');
            document.getElementById('musicIndicator').innerHTML = '<span>üéµ</span> Race Complete!';
            
            // Crown the winner
            document.getElementById('progressBar2').classList.add('winner-pulse');
            document.getElementById('avatar2').style.boxShadow = 
                '0 0 0 8px gold, 0 0 40px rgba(255, 215, 0, 0.8), 0 10px 30px rgba(0, 0, 0, 0.5)';
            
            // Final victory message
            setTimeout(() => {
                document.getElementById('commentary').textContent = 
                    "üèÜüèÜüèÜ VICTORY FOR @MARCEL! ENTERPRISE POWER REIGNS SUPREME! " +
                    "WHAT AN INCREDIBLE RACE FOLKS! THE 1-MINUTE EPIC IS COMPLETE! üéä";
                
                // Mega confetti explosion!
                createVictoryConfetti();
                
                // Re-enable start button
                document.getElementById('startRace').disabled = false;
                document.getElementById('startRace').style.opacity = '1';
                document.getElementById('startRace').innerHTML = '<span>üèÅ</span> START EPIC RACE';
            }, 500);
        }

        // ==================== VICTORY CONFETTI! ====================
        // Because every epic win needs celebration
        function createVictoryConfetti() {
            const symbols = ['üéâ', 'üèÜ', '‚ú®', 'üíé', '‚≠ê', 'üöÄ', 'üí™', 'üî•', '‚ö°', 'üëë'];
            
            for (let i = 0; i < 150; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                    confetti.style.position = 'fixed';
                    confetti.style.fontSize = Math.random() * 25 + 15 + 'px';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-50px';
                    confetti.style.opacity = '0.9';
                    confetti.style.zIndex = '9999';
                    confetti.style.pointerEvents = 'none';
                    confetti.style.filter = 'drop-shadow(0 4px 8px rgba(0,0,0,0.5))';
                    
                    document.body.appendChild(confetti);
                    
                    // Random trajectory for each piece
                    const animation = confetti.animate([
                        { 
                            transform: `translate(0, 0) rotate(0deg)`,
                            opacity: 1 
                        },
                        { 
                            transform: `translate(${Math.random() * 200 - 100}px, ${window.innerHeight + 100}px) rotate(${Math.random() * 720}deg)`,
                            opacity: 0 
                        }
                    ], {
                        duration: Math.random() * 3000 + 1500,
                        easing: 'cubic-bezier(0.215, 0.61, 0.355, 1)'
                    });
                    
                    animation.onfinish = () => confetti.remove();
                }, i * 15);
            }
        }

        // ==================== RESET FUNCTION ====================
        // For when you want to run it all again
        function resetRace() {
            clearInterval(raceInterval);
            raceActive = false;
            
            // Stop music
            raceMusic.pause();
            raceMusic.currentTime = 0;
            document.getElementById('musicIndicator').classList.remove('playing');
            document.getElementById('musicIndicator').innerHTML = '<span>üéµ</span> Race Anthem Ready';
            
            // Reset all variables
            currentTime = 0;
            currentLap = 1;
            progress1 = 0;
            progress2 = 0;
            commentaryIndex = 0;
            lastBoostTime = 0;
            
            // Reset UI
            document.getElementById('raceTimer').textContent = '00:00';
            document.getElementById('fill1').style.width = '0%';
            document.getElementById('fill2').style.width = '0%';
            document.getElementById('lapCounter').textContent = 
                `Lap 1/${RACE_CONFIG.totalLaps} ‚Ä¢ Fast Sprint!`;
            document.getElementById('commentary').textContent = 
                'The horses are in the gates! Who will claim victory today? üèÅ';
            
            // Remove winner effects
            document.getElementById('progressBar2').classList.remove('winner-pulse');
            document.getElementById('avatar2').style.boxShadow = 
                '0 10px 30px rgba(0, 0, 0, 0.5), 0 0 0 4px rgba(255, 255, 255, 0.1)';
            
            // Reset track shadow
            document.querySelector('.track-surface').style.boxShadow = 
                'inset 0 0 100px rgba(0, 0, 0, 0.8), inset 0 0 60px rgba(30, 144, 255, 0.1), 0 20px 60px rgba(0, 0, 0, 0.6)';
            
            // Re-enable start button
            document.getElementById('startRace').disabled = false;
            document.getElementById('startRace').style.opacity = '1';
            document.getElementById('startRace').innerHTML = '<span>üèÅ</span> START EPIC RACE';
            
            // Reset avatar positions
            updateRacePositions();
        }

        // ==================== INITIAL SETUP ====================
        // Run when the page loads
        window.addEventListener('DOMContentLoaded', () => {
            // Set up scores
            document.getElementById('score1').textContent = 
                RACE_CONFIG.racers[0].score.toLocaleString() + ' pts';
            document.getElementById('score2').textContent = 
                RACE_CONFIG.racers[1].score.toLocaleString() + ' pts';
            
            // Initial avatar positioning
            updateRacePositions();
            
            // Preload music
            raceMusic.load();
            
            // Add some motivational text
            console.log("üèá Codeable Sales Derby loaded successfully!");
            console.log("üéØ Ready for a fast 1-minute showdown!");
            console.log("üöÄ May the best sales strategy win!");
        });

        // ==================== RESPONSIVE ADJUSTMENTS ====================
        // Make sure it looks good on all screens
        window.addEventListener('resize', () => {
            if (!raceActive) {
                updateRacePositions();
            }
        });
    </script>
</body>
</html>